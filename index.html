<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Global Expansion Playbook</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4A90E2;
            --secondary-color: #50E3C2;
            --accent-color: #F5A623;
            --text-color: #1a202c; /* gray-900 */
            --text-light: #4a5568; /* gray-700 */
            --bg-color: #f7fafc; /* gray-100 */
            --header-text: #ffffff;
            --footer-bg: #2d3748; /* gray-800 */
            --footer-text: #e2e8f0; /* gray-300 */
        }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }
        .cta-button {
            background-color: var(--secondary-color);
            transition: background-color 0.3s ease;
        }
        .cta-button:hover {
            background-color: #45c9ab;
        }
        #creator-credit a {
            color: var(--secondary-color) !important;
            font-weight: bold;
            text-decoration: none;
        }
        #creator-credit a:hover {
            text-decoration: underline;
        }
        .subtitle-link {
            text-decoration: underline;
            color: inherit !important;
        }
        .subtitle-link:hover {
            color: var(--secondary-color) !important;
        }
        select:disabled {
            background-color: #e9ecef;
            cursor: not-allowed;
            opacity: 0.7;
        }
        select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            -webkit-print-color-adjust: exact;
            -webkit-appearance: none;
            appearance: none;
        }
        details .details-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.7s ease-in-out;
        }
        details[open] .details-content {
            max-height: 5000px;
        }
        details summary {
            cursor: pointer;
            outline: none;
        }
        details summary::-webkit-details-marker {
            display: none;
        }
        .summary-arrow {
            transition: transform 0.3s ease;
        }
        details[open] .summary-arrow {
            transform: rotate(180deg);
        }
        
        #report-nav {
            transition: box-shadow 0.3s ease;
        }
        #report-nav nav {
            gap: 0.5rem 1.5rem; /* Vertical and horizontal gap */
        }
        .nav-scrolled {
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .sub-nav-link {
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-light);
            border-bottom: 2px solid transparent;
            padding: 0.5rem 0.25rem;
            white-space: nowrap; /* Prevent links from breaking */
        }
        @media (min-width: 768px) {
            #report-nav nav {
                gap: 0.5rem 2rem;
            }
        }
        .sub-nav-link:hover {
            color: var(--primary-color);
            border-bottom-color: #dbeafe; /* light blue */
        }
        .sub-nav-link.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            font-weight: 600;
        }
        .consideration-card {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        .consideration-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .consideration-card h4 {
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        #hofstedeChart {
            max-height: 500px;
        }
    </style>
</head>
<body class="bg-gray-100">

    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-12 md:py-16 text-center">
            <h1 class="text-4xl md:text-5xl font-bold leading-tight">The Global Expansion Playbook</h1>
            <p class="mt-4 text-lg md:text-xl max-w-3xl mx-auto opacity-90">Localize your successful US product around the world. Select a country and vertical to generate tailored recommendations based on deep cultural and behavioral analysis.</p>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 -mt-10">
        <div class="bg-white rounded-xl shadow-2xl p-6 md:p-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-end">
                <div class="w-full">
                    <label for="country-select" class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-gray-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM4.332 8.027a6.012 6.012 0 011.912-2.706C6.512 5.72 6.974 6 7.5 6A1.5 1.5 0 019 7.5V8a2 2 0 004 0 2 2 0 011.523-1.943A5.998 5.998 0 0116 9.5a.5.5 0 01-1 0 5 5 0 00-4-4.9c.263-.234.488-.5.672-.803A6.012 6.012 0 0110 4.5c-1.223 0-2.345.416-3.22 1.134A4.002 4.002 0 006 8c-1.105 0-2-.895-2-2a.5.5 0 011 0c.552 0 1 .448 1 .999a.5.5 0 01-.332.474z" clip-rule="evenodd" /></svg>
                        Country
                    </label>
                    <select id="country-select" class="w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 appearance-none">
                        <option value="" disabled selected>Choose a country</option>
                    </select>
                </div>
                <div class="w-full">
                    <label for="vertical-select" class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-gray-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a1 1 0 011-1h5a1 1 0 01.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" /></svg>
                        Vertical
                    </label>
                    <select id="vertical-select" class="w-full bg-gray-200 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 appearance-none" disabled>
                        <option value="">Select a country first</option>
                    </select>
                </div>
                <div class="w-full">
                    <button id="generate-report" class="w-full gradient-bg text-white font-bold py-2.5 px-4 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 disabled:opacity-50 disabled:cursor-not-allowed" disabled>Generate Report</button>
                </div>
            </div>
        </div>

        <div id="report-output" class="mt-8 bg-white rounded-xl shadow-xl p-6 md:p-10 hidden">
            </div>

    </main>

    <footer class="bg-gray-800 text-gray-300 mt-16">
        <div class="container mx-auto px-6 py-12 text-center">
            <p id="creator-credit" class="text-sm">This interactive report was created by <a href="https://www.linkedin.com/in/ayelet-lazarovitch/" target="_blank">Ayelet Lazarovitch</a>, powered by Gemini Deep Research.</p>
            <div class="mt-8 pt-8 border-t border-gray-700 max-w-2xl mx-auto">
                <h3 class="text-2xl font-semibold text-white">Interested in the most effective ways to localize and optimize your product?</h3>
                <h4 class="mt-4 text-base text-gray-400">Hi, I'm <a href="https://www.linkedin.com/in/ayelet-lazarovitch/" target="_blank" class="subtitle-link">Ayelet Lazarovitch</a>, a UX & Product Advisor and former Google Product Specialist who helped over 100 global brands boost performance. Let's connect & find ways to optimize your product.</h4>
                <a href="https://calendly.com/ayelet-ux/quick-intro" target="_blank" class="cta-button inline-block text-white font-bold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 mt-6 no-underline">Book a quick intro</a>
            </div>
             <div class="mt-12 pt-8 border-t border-gray-700 text-center">
                <p id="disclaimer" class="text-xs text-gray-400 max-w-3xl mx-auto mb-2">
                    Disclaimer: The information and recommendations provided in this report are generated by an AI model based on the attached research documents. While created to be insightful, they may not be suitable for all products or contexts. It is crucial to conduct your own testing and validation to ensure these strategies are effective for your specific business goals.
                </p>
                <p id="copyright" class="text-xs text-gray-500">&copy; 2024 Ayelet Lazarovitch. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- Global Variables ---
        let localizationData = {};
        const countrySelect = document.getElementById('country-select');
        const verticalSelect = document.getElementById('vertical-select');
        const generateBtn = document.getElementById('generate-report');
        const reportOutput = document.getElementById('report-output');
        let chartInstance = null;
        let scrollTimeout;

        // --- Data Fetching ---
        fetch('database-localization.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }
                return response.json();
            })
            .then(data => {
                localizationData = data.localization_playbooks;
                // Add USA data for comparison, assuming it might be needed for the chart
                localizationData["usa"] = { "hofstede_analysis": [ { "dimension_name": "Power Distance", "score": 40 }, { "dimension_name": "Individualism", "score": 91 }, { "dimension_name": "Masculinity", "score": 62 }, { "dimension_name": "Uncertainty Avoidance", "score": 46 }, { "dimension_name": "Long-Term Orientation", "score": 26 }, { "dimension_name": "Indulgence", "score": 68 } ] };
                populateCountryDropdown();
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
                reportOutput.innerHTML = `<p class="text-center text-red-500 font-semibold">Could not load the localization data. Please try again later.</p>`;
                reportOutput.classList.remove('hidden');
            });

        // --- Functions ---
        function populateCountryDropdown() {
            const countries = Object.keys(localizationData).filter(k => k !== 'usa').sort();
            countries.forEach(country => {
                const optionEl = document.createElement('option');
                optionEl.value = country;
                optionEl.textContent = country.charAt(0).toUpperCase() + country.slice(1);
                countrySelect.appendChild(optionEl);
            });
        }
        
        function updateDependentDropdowns() {
            const selectedCountry = countrySelect.value;
            const countryData = localizationData[selectedCountry];

            // Reset and disable vertical select and button
            verticalSelect.disabled = true;
            generateBtn.disabled = true;
            verticalSelect.innerHTML = '<option value="">Select a vertical</option>';
            verticalSelect.classList.add('bg-gray-200');
            verticalSelect.classList.remove('bg-gray-50');

            if (selectedCountry && countryData) {
                verticalSelect.disabled = false;
                verticalSelect.classList.remove('bg-gray-200');
                verticalSelect.classList.add('bg-gray-50');
                
                const verticals = Object.keys(countryData).filter(k => !["hofstede_analysis", "overall_diff"].includes(k)).sort();
                verticals.forEach(vertical => {
                    const optionEl = document.createElement('option');
                    optionEl.value = vertical;
                    optionEl.textContent = vertical;
                    verticalSelect.appendChild(optionEl);
                });
            }
        }
        
        function checkGenerateButtonState() {
            const country = countrySelect.value;
            const vertical = verticalSelect.value;
            if (country && vertical) {
                generateBtn.disabled = false;
            } else {
                generateBtn.disabled = true;
            }
        }
        
        // Transforms the array from the JSON into an object the chart can use
        function getHofstedeScores(hofstedeArray) {
            const scores = {};
            const dimensionMap = {
                'Power Distance': 'pdi', 'Individualism': 'idv', 'Masculinity': 'mas',
                'Uncertainty Avoidance': 'uai', 'Long-Term Orientation': 'lto', 'Indulgence': 'ivr'
            };
            hofstedeArray.forEach(dim => {
                const key = dimensionMap[dim.dimension_name];
                if(key) {
                    // The JSON has scores in the main object, not a nested score property
                    scores[key] = dim.score || parseInt(dim.impact_on_localization.match(/\((\d+)/)?.[1] || 0);
                }
            });
            return scores;
        }

        function renderRadarChart(countryData, usaData) {
            if (chartInstance) chartInstance.destroy();
            const canvas = document.getElementById('hofstedeChart');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            
            const countryScores = getHofstedeScores(countryData.hofstede_analysis);
            const usaScores = getHofstedeScores(usaData.hofstede_analysis);

            const labels = [
                ['Power', 'Distance'], 'Individualism', 'Masculinity', ['Uncertainty', 'Avoidance'], ['Long-Term', 'Orientation'], 'Indulgence'
            ];
            
            const pointLabelFontSize = window.innerWidth < 640 ? 10 : 12;

            chartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: countrySelect.options[countrySelect.selectedIndex].text,
                        data: [countryScores.pdi, countryScores.idv, countryScores.mas, countryScores.uai, countryScores.lto, countryScores.ivr],
                        backgroundColor: 'rgba(74, 144, 226, 0.2)',
                        borderColor: 'rgba(74, 144, 226, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(74, 144, 226, 1)',
                    }, {
                        label: 'USA',
                        data: [usaScores.pdi, usaScores.idv, usaScores.mas, usaScores.uai, usaScores.lto, usaScores.ivr],
                        backgroundColor: 'rgba(80, 227, 194, 0.2)',
                        borderColor: 'rgba(80, 227, 194, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(80, 227, 194, 1)',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: { 
                                font: { size: pointLabelFontSize, weight: '600' }, 
                                color: '#4a5568'
                            },
                            ticks: {
                                backdropColor: 'rgba(255, 255, 255, 0.75)',
                                stepSize: 20
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    },
                    plugins: {
                        legend: { position: 'bottom', labels: { font: { size: 14 } } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.r !== null) {
                                        label += context.parsed.r;
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        function handleScrollSpy() {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                const reportNavEl = document.getElementById('report-nav');
                if (!reportNavEl) return;
                
                // This function now only handles the scroll effects for larger screens
                if (window.innerWidth < 768) return;

                const navContainerTop = document.querySelector('.container').offsetTop;
                if (window.scrollY > navContainerTop) {
                    reportNavEl.classList.add('nav-scrolled');
                } else {
                    reportNavEl.classList.remove('nav-scrolled');
                }
                
                const sections = document.querySelectorAll('#report-content section');
                let currentSectionId = '';
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (window.scrollY >= sectionTop - 150) {
                        currentSectionId = section.getAttribute('id');
                    }
                });

                document.querySelectorAll('.sub-nav-link').forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === '#' + currentSectionId) {
                        link.classList.add('active');
                    }
                });
            }, 50);
        }

        function generateReport() {
            window.removeEventListener('scroll', handleScrollSpy);

            const country = countrySelect.value;
            const vertical = verticalSelect.value;

            if (!country || !vertical) {
                const msgBox = document.createElement('div');
                msgBox.textContent = 'Please select a country and a vertical.';
                msgBox.className = 'fixed top-5 right-5 bg-red-500 text-white py-2 px-4 rounded-lg shadow-lg animate-pulse';
                document.body.appendChild(msgBox);
                setTimeout(() => msgBox.remove(), 3000);
                return;
            }

            const countryData = localizationData[country];
            const content = countryData[vertical];
            
            if (!content || !content.overview || !content.top_10_recommendations) {
                reportOutput.innerHTML = `<p class="text-center text-red-500 font-semibold">Sorry, specific data for this combination is not yet available. Please try another selection.</p>`;
                reportOutput.classList.remove('hidden');
                return;
            }
            
            const { overview, cultural_differences, hofstede_analysis, top_10_recommendations } = content;
            const countryName = country.charAt(0).toUpperCase() + country.slice(1);
            const verticalName = vertical.charAt(0).toUpperCase() + vertical.slice(1);

            // Dynamic Titles
            const overviewTitle = `Localization overview for ${verticalName} in ${countryName}`;
            const recommendationTitle = `Top 10 Localization Recommendations for ${verticalName} in ${countryName}`;
            
            let reportHTML = `
                <div id="report-nav" class="border-b border-gray-200 mb-8 sticky top-0 bg-white/90 backdrop-blur-sm z-10 py-2 -mx-6 px-6 md:-mx-10 md:px-10">
                    <nav aria-label="Sections" class="hidden md:flex justify-center">
                        <a href="#section-overview" class="sub-nav-link">Overview</a>
                        <a href="#section-comparison" class="sub-nav-link">Cultural Comparison</a>
                        <a href="#section-recommendations" class="sub-nav-link">Recommendations</a>
                    </nav>
                </div>

                <div id="report-content">
                    <section id="section-overview" class="mb-12 scroll-mt-24">
                        <div class="text-center mb-8">
                             <h2 class="text-3xl font-bold text-gray-800">${overviewTitle}</h2>
                             <p class="text-lg text-gray-600 mt-2 max-w-3xl mx-auto">${overview}</p>
                        </div>
                    </section>

                    <section id="section-comparison" class="mb-12 scroll-mt-24">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Cultural Differences: ${countryName} vs. USA</h3>
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            ${cultural_differences.map((diff, index) => {
                                const colors = ['var(--primary-color)', '#5ab95f', 'var(--accent-color)', '#5a67b9'];
                                const color = colors[index % 4];
                                return `
                                <div class="bg-gray-50 rounded-lg p-6 border-l-4" style="border-color: ${color};">
                                    <h4 class="font-bold text-lg mb-2" style="color: ${color};">${diff.title}</h4>
                                    <p class="text-base text-gray-700">${diff.description}</p>
                                </div>
                                `;
                            }).join('')}
                        </div>
                        <details class="mt-8 group bg-gray-50 rounded-lg p-4">
                            <summary class="flex justify-between items-center cursor-pointer text-xl font-bold text-gray-800 list-none">
                                In-depth cultural comparison vs. USA
                                <span class="summary-arrow text-gray-500">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
                                </span>
                            </summary>
                            <div class="details-content">
                                <div class="mt-6 bg-white p-4 rounded-lg h-[400px] md:h-[500px] relative"><canvas id="hofstedeChart"></canvas></div>
                                <div class="mt-6 space-y-4">
                                    ${hofstede_analysis.map(dim => `
                                        <div class="bg-white p-4 rounded-lg shadow-sm">
                                            <p class="text-base text-gray-800"><strong class="text-gray-900">${dim.dimension_name}:</strong> ${dim.impact_on_localization}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </details>
                    </section>

                    <section id="section-recommendations" class="scroll-mt-24">
                         <div class="text-center mb-6">
                            <h3 class="text-2xl font-bold text-gray-800">${recommendationTitle}</h3>
                            <p class="text-base text-gray-600 mt-1 max-w-2xl mx-auto">Use this data-driven framework as your foundation, then test and tailor it to your unique product for the win.</p>
                        </div>
                        <div class="space-y-2">
                            ${top_10_recommendations.map((rec, index) => `
                                <details class="group bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden">
                                    <summary class="flex items-center gap-4 p-4 cursor-pointer list-none">
                                        <span class="flex-shrink-0 flex items-center justify-center h-10 w-10 rounded-full gradient-bg text-white font-bold text-lg">${index + 1}</span>
                                        <h4 class="text-lg md:text-xl text-gray-800 flex-1 font-medium">${rec.title}</h4>
                                        <span class="summary-arrow text-gray-500">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
                                        </span>
                                    </summary>
                                    <div class="details-content">
                                        <div class="px-6 pb-6 pt-4 border-t border-gray-200 space-y-3">
                                            <p class="text-base text-gray-700"><strong class="text-gray-900">Why this is important:</strong> ${rec.importance}</p>
                                            <p class="text-base text-gray-700"><strong class="text-gray-900">How to implement:</strong> ${rec.implementation}</p>
                                        </div>
                                    </div>
                                </details>
                            `).join('')}
                        </div>
                    </section>
                </div>
            `;
            
            reportOutput.innerHTML = reportHTML;
            reportOutput.classList.remove('hidden');
            
            // Scroll to the report section smoothly
            reportOutput.scrollIntoView({ behavior: 'smooth', block: 'start' });

            renderRadarChart(countryData, localizationData.usa);
            window.addEventListener('scroll', handleScrollSpy, { passive: true });
            handleScrollSpy(); // Initial call
        }
        
        // --- Event Listeners ---
        countrySelect.addEventListener('change', updateDependentDropdowns);
        verticalSelect.addEventListener('change', checkGenerateButtonState);
        generateBtn.addEventListener('click', generateReport);
        document.getElementById('copyright').innerHTML = `&copy; ${new Date().getFullYear()} Ayelet Lazarovitch. All rights reserved.`;
        
    });
    </script>
</body>
</html>